# nexign-task

Проект Nexign Bootcamp, выполнил Данила Сладков. Telegram @sladkkov.

Использованные технологии: 
Spring Boot, Spring Data Jpa, PostgreSQL, Kafka, OpenApi, MapStruct, Liquibase. 


Для запуска приложения необходимо запустить: docker-compose.yaml находящийся в корневой папке проекта. При ошибке проверить доступность всех портов. 
После этого сделать mvn install для модуля common
Запустить остальные микросервисы, не важно в какой очередности.

Swagger doc: http://localhost:7653/swagger-ui/index.html#/ 
KafDrop: http://localhost:9000/ (ui для кафки)


Опишу проект. В модуле cdr, создаются абоненты и записываются в БД. По номерам этиъ абонентов создаются CDR, и каждая CDR отправляется в топик Кафки brt-topic. 
В brt происходит проверка баланса, и если всё проходит успешно, cdr наполняется данными о тарифе и отправляется в hrs. Там происходит расчёт стоимости звонка и возвращается в brt.

Разработка и проектирования тарифа в БД мне показалось не лучшим рещением, т.к. любой новый тариф ломал бы всё и пришлось бы переписывать много кода. 
Поэтому принял решение в БД хранить только Id и Имя тарифа, а всю логику реализовывать с помощью паттерна стратегия.

Ещё момент о котором хочу сказать, сделал запись cdr в файлы txt и парсинг на всех этапах программы, но в итоге ушел от этого подхода, т.к. мне хотелось, 
чтобы cdr обрабатывались в реальном времени. Для этого нужно было делать нотификацию микросервисов, для обработки, через брокер сообщений. 
В общем в ходе своих рассуждений, я остановился на 1 варианте. 

Все общие Сервисы, Репозитории, Модели и Дто вынесены в модуль common
